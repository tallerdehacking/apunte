<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.ddfbf41cc15c16add8b3d14df7854d6638589653939d95d9cf5fe4d3daf5bf79bfe19fe129947c9b826d71d46a6ebe6511885864fd42d2dabe157092d30cf1a8.css integrity="sha512-3fv0HMFcFq3Ys9FN94VNZjhYllOTnZXZz1/k09r1v3m/4Z/hKZR8m4JtcdRqbr5lEYhYZP1C0tq+FXCS0wzxqA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Deobfuscación - Taller de Hacking Competitivo</title><meta name=description content="DCC universidad de Chile"><link rel=canonical href=/docs/reversa/deobfuscation/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo_redondo.png"><meta name=twitter:title content="Deobfuscación"><meta name=twitter:description content="La deobfuscación de ejecutables es similar a la deobfuscación de JavaScript que vimos en los capítulos de esteganografía y aplicaciones web. La diferencia siendo que el código ahora puede estar compilado, y por lo tanto las operaciones utilizadas para obfuscar la funcionalidad podrían estar a nivel de microcódigo.
Este tipo de obfuscación no hace más seguras las aplicaciones, ya que con suficiente trabajo siempre pueden ser deobfuscadas, sino que intenta dificultar la lectura y entendimiento de estas a personas que no tengan acceso al código fuente."><meta name=twitter:site content="@dccuchile"><meta name=twitter:creator content="@dccuchile"><meta property="og:title" content="Deobfuscación"><meta property="og:description" content="La deobfuscación de ejecutables es similar a la deobfuscación de JavaScript que vimos en los capítulos de esteganografía y aplicaciones web. La diferencia siendo que el código ahora puede estar compilado, y por lo tanto las operaciones utilizadas para obfuscar la funcionalidad podrían estar a nivel de microcódigo.
Este tipo de obfuscación no hace más seguras las aplicaciones, ya que con suficiente trabajo siempre pueden ser deobfuscadas, sino que intenta dificultar la lectura y entendimiento de estas a personas que no tengan acceso al código fuente."><meta property="og:type" content="article"><meta property="og:url" content="/docs/reversa/deobfuscation/"><meta property="og:image" content="/logo_redondo.png"><meta property="article:published_time" content="2020-10-06T08:48:45+00:00"><meta property="article:modified_time" content="2023-06-16T12:44:00-04:00"><meta property="og:site_name" content="Taller de Hacking Competitivo"><meta property="article:publisher" content="https://www.facebook.com/DCCUChile"><meta property="article:author" content="https://www.facebook.com/DCCUChile"><meta property="og:locale" content="es_CL"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Docsreversadeobfuscation","item":"\/docsreversadeobfuscation\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/><img class=logo-light src=/images/banner.svg></img>
<img class=logo-dark src=/images/banner_dark.svg></img></a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/cc5325/apunte><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=/blog/>Videos</a></li><li class=nav-item><a class=nav-link href=/docs/prologo/intro>Apunte</a></li><li class=nav-item><a class=nav-link href=/writeups/>Writeups</a></li><li class=nav-item><a class=nav-link href=/tareas/>Evaluaciones</a></li><li class=nav-item><a class=nav-link href=/acerca>Acerca</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Buscar Documentación..." aria-label="Buscar Documentación..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Prólogo</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/prologo/intro/>Prólogo</a></li></ul><h3>Esteganografía</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/stego/intro/>Intro a la Esteganografía</a></li><li><a class=docs-link href=/docs/stego/conceptos-basicos/>Conceptos Básicos</a></li><li><a class=docs-link href=/docs/stego/cripto-clasica/>Criptografía Clásica</a></li><li><a class=docs-link href=/docs/stego/stego/>Stego en texto, imágenes y audio</a></li><li><a class=docs-link href=/docs/stego/ejercicios/>Ejercicios de Stego</a></li></ul><h3>Criptografía Moderna</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/cripto-moderna/intro/>Intro a Criptografía Moderna</a></li><li><a class=docs-link href=/docs/cripto-moderna/hashing/>Hashing</a></li><li><a class=docs-link href=/docs/cripto-moderna/cripto-simetrica/>Criptografía Simétrica</a></li><li><a class=docs-link href=/docs/cripto-moderna/cripto-asimetrica/>Criptografía Asimétrica</a></li><li><a class=docs-link href=/docs/cripto-moderna/ejercicios/>Ejercicios Cripto Moderna</a></li></ul><h3>Aplicaciones Web</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/apps-web/intro/>Intro a Aplicaciones Web</a></li><li><a class=docs-link href=/docs/apps-web/tecnicas-basicas/>Técnicas Básicas de Análisis Web</a></li><li><a class=docs-link href=/docs/apps-web/xss/>Cross-Site Scripting</a></li><li><a class=docs-link href=/docs/apps-web/inyecciones/>Inyecciones</a></li><li><a class=docs-link href=/docs/apps-web/rce/>Remote Code Execution</a></li><li><a class=docs-link href=/docs/apps-web/reverse-shell/>Reverse Shell</a></li><li><a class=docs-link href=/docs/apps-web/cve/>Common Vulnerabilities and Exposures</a></li><li><a class=docs-link href=/docs/apps-web/ejercicios/>Ejercicios Apps Web</a></li></ul><h3>Análisis Forense</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/forense/intro/>Introducción al Análisis Forense</a></li><li><a class=docs-link href=/docs/forense/cmd-logs/>Comandos, Logs y Configuraciones</a></li><li><a class=docs-link href=/docs/forense/versionado-recuperacion/>Versionado y Recuperación de Archivos</a></li><li><a class=docs-link href=/docs/forense/wireshark/>Wireshark</a></li><li><a class=docs-link href=/docs/forense/ejercicios/>Ejercicios de Forense</a></li></ul><h3>Ingeniería Reversa</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/reversa/intro/>Intro a la Ingeniería Reversa</a></li><li><a class=docs-link href=/docs/reversa/decompiling/>Decompilación</a></li><li><a class="docs-link active" href=/docs/reversa/deobfuscation/>Deobfuscación</a></li><li><a class=docs-link href=/docs/reversa/ejercicios/>Ejercicios Reversing</a></li></ul><h3>Pwning</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/pwning/intro/>Intro al Pwning</a></li><li><a class=docs-link href=/docs/pwning/permisos-linux/>Permisos de Usuario en Linux</a></li><li><a class=docs-link href=/docs/pwning/escalamiento-privilegios/>Escalamiento de Privilegios</a></li><li><a class=docs-link href=/docs/pwning/buffer-overflow/>Buffer Overflow</a></li><li><a class=docs-link href=/docs/pwning/ejercicios/>Ejercicios de Pwning</a></li></ul><h3>OSINT</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/osint/intro/>Intro a OSINT</a></li><li><a class=docs-link href=/docs/osint/google/>Google Hacking</a></li><li><a class=docs-link href=/docs/osint/github/>Búsqueda en Github</a></li><li><a class=docs-link href=/docs/osint/theharvester/>The Harvester</a></li><li><a class=docs-link href=/docs/osint/haveibeenpwned/>Have I Been Pwned</a></li><li><a class=docs-link href=/docs/osint/shodan/>Shodan</a></li><li><a class=docs-link href=/docs/osint/ejercicios/>Ejercicios OSINT</a></li></ul><h3>Anexos</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/anexos/herramientas/>Herramientas</a></li><li><a class=docs-link href=/docs/anexos/vpn/>Configuración de VPN</a></li><li><a class=docs-link href=/docs/anexos/kali/>Kali Linux</a></li><li><a class=docs-link href=/docs/anexos/proxy/>Proxy</a></li><li><a class=docs-link href=/docs/anexos/comandos/>Comandos de Terminal de Linux</a></li><li><a class=docs-link href=/docs/anexos/referencias/>Referencias</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>Contenidos</h3><nav id=TableOfContents><ul><li><a href=#obfuscación-básica>Obfuscación Básica</a></li><li><a href=#eval>Eval</a></li><li><a href=#string-splitting>String Splitting</a></li><li><a href=#dead-branches>Dead Branches</a></li><li><a href=#cómo-deobfuscar-código>¿Cómo Deobfuscar Código?</a><ul><li><a href=#javascript>JavaScript</a></li><li><a href=#python>Python</a></li><li><a href=#php>PHP</a></li><li><a href=#java>Java</a></li><li><a href=#net>.NET</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Deobfuscación</h1><p class=lead></p><p>La deobfuscación de ejecutables es similar a la deobfuscación de JavaScript que vimos en los capítulos de
esteganografía y aplicaciones web. La diferencia siendo que el código ahora puede estar compilado,
y por lo tanto las operaciones utilizadas para obfuscar la funcionalidad podrían estar a nivel de microcódigo.</p><p>Este tipo de obfuscación no hace más seguras las aplicaciones, ya que con suficiente trabajo siempre pueden
ser deobfuscadas, sino que intenta dificultar la lectura y entendimiento de estas a personas que no tengan
acceso al código fuente. Esto finalmente retrasa el hallazgo de diferentes tipos de vulnerabilidades, ya que
impone un trabajo previo a la investigación.</p><p>La obfuscación suele usarse también para ocultar <em>malware</em> y evitar que sea detectado por sistemas de antivirus.
Estos funcionan mayoritariamente por la detección de firmas (<em>signatures</em>) de virus y malware conocidos, que
intentan identificarlos usando su ejecutable o comandos utilizados. La obfuscación puede cambiar la firma de un
ejecutable, y por lo tanto evadir la detección del antivirus.</p><h2 id=obfuscación-básica>Obfuscación Básica<a href=#obfuscación-básica class=anchor aria-hidden=true>#</a></h2><p>La obfuscación más básica, la cual solo es efectiva si el código original ya es relativamente complejo y extenso,
es modificar los nombres de variables, funciones y clases por caracteres aleatorios, al igual que quitar
todo tipo de comentarios e información extra que pueda ayudar a alguien a comprender su significado.
Luego, el código resultante no entrega ningún tipo de contexto sobre su funcionamiento, y este debe ser
analizado cuidadosamente para entenderlo.</p><p>Como ejemplo, tenemos este simple código en PHP que calcula la raíz cuadrada de un número usando el método de Newton.
A pesar de ser un código muy breve y sin mucha complejidad, esta obfuscación ya impone algo de esfuerzo para
entenderlo.</p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=k>function</span> <span class=nf>a0</span><span class=p>(</span><span class=nv>$f1</span><span class=p>,</span><span class=nv>$c2</span><span class=p>){</span>
  <span class=nv>$w3</span><span class=o>=</span><span class=nv>$f1</span><span class=p>;</span>
  <span class=k>for</span><span class=p>(</span><span class=nv>$r4</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nv>$r4</span><span class=o>&lt;</span><span class=nv>$c2</span><span class=p>;</span><span class=nv>$r4</span><span class=o>++</span><span class=p>){</span>
    <span class=nv>$w3</span><span class=o>=</span><span class=mf>0.5</span><span class=o>*</span><span class=p>(</span><span class=nv>$w3</span><span class=o>+</span><span class=p>(</span><span class=nv>$f1</span><span class=o>/</span><span class=nv>$w3</span><span class=p>));</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=nv>$w3</span><span class=p>;</span>
<span class=p>}</span>
<span class=nv>$f1</span><span class=o>=</span><span class=nv>$b5</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=nv>$c2</span><span class=o>=</span><span class=nv>$b5</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=nv>$w3</span><span class=o>=</span><span class=nx>a0</span><span class=p>(</span><span class=nv>$f1</span><span class=p>,</span><span class=nv>$c2</span><span class=p>);</span>
<span class=k>echo</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$w3\n</span><span class=s2>&#34;</span><span class=p>);</span>
</code></pre></div><h2 id=eval>Eval<a href=#eval class=anchor aria-hidden=true>#</a></h2><p>Otra forma simple de obfuscación, utilizada mayoritariamente en lenguajes interpretados
(Python, PHP, JavaScript, etc) con la capacidad de evaluar código en tiempo de ejecución
(también es posible para lenguajes compilados como C/C++, Java o VBA, pero suele ser algo más complejo),
es el uso de codificación, compresión y encriptación (en cualquier orden y no necesariamente todos al mismo tiempo).
Es decir, se toma el payload, o código que se quiera obfuscar,
se codifica, comprime y encripta, y se almacena como un string o una constante en el código. Luego, al momento de
ejecutarlo, se debe desencriptar, descomprimir y decodificar, para finalmente evaluarlo (usando una función como
<em>eval</em> o <em>exec</em>) en tiempo de ejecución.</p><p>Como ejemplo tenemos este pequeño código en Python. Pueden intentar decodificar ustedes mismos el payload.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>b64decode</span>
<span class=kn>from</span> <span class=nn>zlib</span> <span class=kn>import</span> <span class=n>decompress</span>

<span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;eJw1yzEKwkAQBdCr/ExlQPYC4gFsbNLaaHZwPyQza2YEc3ttbB+8vtHyIFd/eN2hn65zBrIppn43RsPFXm8Gk26DHNXqWW6bjKf+n4nqptg1SymYfNVstCcYiOSyYGXEDwYZv35UJm0=&#39;</span>
<span class=n>decoded</span> <span class=o>=</span> <span class=n>b64decode</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
<span class=n>decompressed</span> <span class=o>=</span> <span class=n>decompress</span><span class=p>(</span><span class=n>decoded</span><span class=p>)</span>

<span class=k>exec</span><span class=p>(</span><span class=n>decompressed</span><span class=p>)</span>
</code></pre></div><p>Por sí solos estos métodos no son muy efectivos en contra de un humano (aunque sí contra muchos antivirus),
pues es muy evidente en dónde se está escondiendo el payload y cómo decodificarlo.</p><p>Para utilizar esta técnica con lenguajes compilados hay 2 opciones. La primera es pedirle al compilador que compile
el código decodificado y luego ejecutar el archivo resultante. El problema es que muchas veces la llamada al
compilador marca al programa como posible malware y este se bloquea.</p><p>La otra opción es tener el microcódigo compilado directamente almacenado en el código como payload. Luego, solo
se necesita crear un archivo con este contenido o cambiar el contenido de memoria de un proceso por el
microcódigo.</p><h2 id=string-splitting>String Splitting<a href=#string-splitting class=anchor aria-hidden=true>#</a></h2><p>El <em>string splitting</em>, o separación de strings, es un método utilizado para esconder constantes de tipo string
(como contraseñas, llaves privadas, URLs, mensajes, etc) en diversas partes.
Luego, todas estas partes se mezclan de cierta forma en particular para producir la variable original.
Las operaciones comúnmente utilizadas para esto son la concatenación, casting,
codificación en distintos estándares de texto, substrings, entre otros.</p><p>Por ejemplo, este código JavaScript esconde una contraseña obfuscada usando string splitting.
Notar que no todas las secciones se utilizan para construir la contraseña.</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>var</span> <span class=nx>_0xfb5e</span><span class=o>=</span><span class=p>[</span>
  <span class=s1>&#39;\x31\x33\x32\x30\x33\x35\x78\x6b\x4b\x76\x44\x62&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x38\x4b\x6e\x7a\x6b\x74\x6c&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x31\x30\x30\x30\x38\x45\x79\x6b\x4d\x68\x69&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x24\x77\x30\x72&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x31\x38\x38\x32\x33\x34\x6e\x6b\x73\x41\x55\x6a&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x31\x30\x33\x36\x39\x35\x6f\x67\x54\x6e\x6f\x4a&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x33\x63\x72\x65&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x70\x33\x72\x53&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x36\x36\x36\x36\x54\x6e\x52\x54\x6a\x73&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x74\x50\x34\x73&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x32\x37\x30\x38\x36\x38\x47\x61\x4b\x61\x50\x5a&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x35\x38\x6d\x77\x67\x68\x6e\x50&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x32\x39\x35\x33\x37\x79\x54\x62\x62\x42\x58&#39;</span><span class=p>,</span>
  <span class=s1>&#39;\x4d\x79\x24\x75&#39;</span>
<span class=p>];</span>
<span class=kd>var</span> <span class=nx>_0x3683a0</span><span class=o>=</span><span class=nx>_0x45f1</span><span class=p>;</span>
<span class=kd>function</span> <span class=nx>_0x45f1</span><span class=p>(</span><span class=nx>_0x2320c9</span><span class=p>,</span><span class=nx>_0xd2858e</span><span class=p>){</span>
    <span class=nx>_0x2320c9</span><span class=o>=</span><span class=nx>_0x2320c9</span><span class=o>-</span><span class=mh>0x10c</span><span class=p>;</span>
    <span class=kd>var</span> <span class=nx>_0xfb5e0e</span><span class=o>=</span><span class=nx>_0xfb5e</span><span class=p>[</span><span class=nx>_0x2320c9</span><span class=p>];</span>
    <span class=k>return</span> <span class=nx>_0xfb5e0e</span><span class=p>;</span>
<span class=p>}(</span>
    <span class=kd>function</span><span class=p>(</span><span class=nx>_0x165719</span><span class=p>,</span><span class=nx>_0x10ce39</span><span class=p>){</span>
        <span class=kd>var</span> <span class=nx>_0x2163ea</span><span class=o>=</span><span class=nx>_0x45f1</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(</span><span class=kc>true</span><span class=p>){</span>
            <span class=k>try</span><span class=p>{</span>
                <span class=kd>var</span> <span class=nx>_0x26183c</span><span class=o>=</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x118</span><span class=p>))</span><span class=o>+-</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x10c</span><span class=p>))</span><span class=o>*</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x10f</span><span class=p>))</span><span class=o>+-</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x113</span><span class=p>))</span><span class=o>+-</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x10e</span><span class=p>))</span><span class=o>+-</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x112</span><span class=p>))</span><span class=o>+</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x116</span><span class=p>))</span><span class=o>+-</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x119</span><span class=p>))</span><span class=o>*-</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>_0x2163ea</span><span class=p>(</span><span class=mh>0x110</span><span class=p>));</span>
                <span class=k>if</span><span class=p>(</span><span class=nx>_0x26183c</span><span class=o>===</span><span class=nx>_0x10ce39</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span>
                <span class=k>else</span> <span class=nx>_0x165719</span><span class=p>[</span><span class=s1>&#39;push&#39;</span><span class=p>](</span><span class=nx>_0x165719</span><span class=p>[</span><span class=s1>&#39;shift&#39;</span><span class=p>]());</span>
            <span class=p>}</span><span class=k>catch</span><span class=p>(</span><span class=nx>_0x3d8331</span><span class=p>){</span>
                <span class=nx>_0x165719</span><span class=p>[</span><span class=s1>&#39;push&#39;</span><span class=p>](</span><span class=nx>_0x165719</span><span class=p>[</span><span class=s1>&#39;shift&#39;</span><span class=p>]());</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}(</span><span class=nx>_0xfb5e</span><span class=p>,</span><span class=mh>0x3046a</span><span class=p>)</span>
<span class=p>);</span>
<span class=kd>var</span> <span class=nx>password</span><span class=o>=</span><span class=nx>_0x3683a0</span><span class=p>(</span><span class=mh>0x10d</span><span class=p>)</span><span class=o>+</span><span class=nx>_0x3683a0</span><span class=p>(</span><span class=mh>0x115</span><span class=p>)</span><span class=o>+</span><span class=nx>_0x3683a0</span><span class=p>(</span><span class=mh>0x114</span><span class=p>)</span><span class=o>+</span><span class=nx>_0x3683a0</span><span class=p>(</span><span class=mh>0x117</span><span class=p>)</span><span class=o>+</span><span class=nx>_0x3683a0</span><span class=p>(</span><span class=mh>0x111</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;\x64&#39;</span><span class=p>;</span>
</code></pre></div><p>A diferencia de la técnica anterior, es muy difícil para una persona saber qué es lo que está pasando y cómo se
construye la variable.</p><h2 id=dead-branches>Dead Branches<a href=#dead-branches class=anchor aria-hidden=true>#</a></h2><p>Otra forma de obfuscar el código es insertando ramas condicionales (declaraciones <code>if</code>, <code>else</code>, <code>switch</code>, <code>while</code>, etc),
de las cuales una nunca será ejecutada, pero no es fácil determinar cuál a primera vista.
Las ramas <em>&ldquo;muertas&rdquo;</em> se llenan de código similar al código real para hacer difícil el proceso de deobfuscación.</p><p>Esta técnica muchas veces va acompañada del uso de <em>código muerto</em>. No se utiliza ramas condicionales en este caso,
sino que se inserta instrucciones, las cuales son ejecutadas, pero no tienen ninguna influencia sobre el resultado
o el funcionamiento del programa en general. La idea es confundir aún más a las personas tratando de reversar
el código.</p><p>Todo esto produce un código que parece ser muy complejo, con muchos caminos de ejecución, los cuales son
intencionalmente poco claros.</p><h2 id=cómo-deobfuscar-código>¿Cómo Deobfuscar Código?<a href=#cómo-deobfuscar-código class=anchor aria-hidden=true>#</a></h2><p>Lamentablemente no existen una fórmula mágica para deobfuscar código obfuscado. Hay herramientas que pueden
ayudar a hacerlo, pero casi nunca logran obtener algo exactamente igual al código original.
Por esto, frecuentemente se debe hacer un análisis manual del código, revisando línea por línea y utilizando
múltiples deobfuscadores.</p><p>Los deobfuscadores normalmente están hechos para funcionar con un lenguaje en particular, y solo pueden
deobfuscar ciertas técnicas. A continuación se encuentra una lista de algunos deobfuscadores que les pueden ser
útiles, sin embargo, existen muchos otros que funcionan igual de bien o incluso mejor.</p><h3 id=javascript>JavaScript<a href=#javascript class=anchor aria-hidden=true>#</a></h3><ul><li><a href=https://lelinhtinh.github.io/de4js/>de4js</a></li><li><a href=http://jsnice.org/>JS Nice</a></li><li><a href=https://www.dcode.fr/javascript-unobfuscator>dCode</a></li><li><a href=https://codeamaze.com/code-beautifier/javascript-deobfuscator>Code Amaze</a></li><li><a href=http://deobfuscatejavascript.com/>Deobfuscate JavaScript</a></li></ul><h3 id=python>Python<a href=#python class=anchor aria-hidden=true>#</a></h3><ul><li><a href=https://github.com/extremecoders-re/bytecode_simplifier>Bytecode Simplifier</a></li><li><a href=https://pypi.org/project/deopy/>deopy</a> (Python3.6+)</li></ul><h3 id=php>PHP<a href=#php class=anchor aria-hidden=true>#</a></h3><ul><li><a href=https://www.unphp.net/>UnPHP</a></li><li><a href=https://github.com/simon816/PHPDeobfuscator>PHPDeobfuscator</a></li><li><a href=https://github.com/Antelox/FOPO-PHP-Deobfuscator>FOPO PHP Deobfuscator</a></li><li><a href=http://jonhburn2.freehostia.com/decode/>PHP Deobfuscator</a></li></ul><h3 id=java>Java<a href=#java class=anchor aria-hidden=true>#</a></h3><ul><li><a href=https://github.com/java-deobfuscator/deobfuscator>Deobfuscator</a></li><li><a href=https://jdec.app/>jdec</a></li><li><a href=https://github.com/D3Hunter/deobfuscator>All-in-one deobfuscator</a></li></ul><h3 id=net>.NET<a href=#net class=anchor aria-hidden=true>#</a></h3><ul><li><a href=https://github.com/de4dot/de4dot>de4dot</a></li><li><a href=https://github.com/NotPrab/.NET-Deobfuscator>Lista de deobfuscadores opensource</a></li></ul><p class=edit-page><a href=https://github.com/cc5325/apunte/blob/main/content/docs/reversa/deobfuscation.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Editar en GitHub</a>
<span class=date-info><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Modificado por última vez el 16/06/2023 a las 12:44:00 hrs.</span></p><div class="docs-navigation d-flex justify-content-between"><a href=/docs/reversa/decompiling/><div class="card my-1"><div class="card-body py-2">&larr; Decompilación</div></div></a><a class=ml-auto href=/docs/reversa/ejercicios/><div class="card my-1"><div class="card-body py-2">Ejercicios Reversing &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Sitio generado con <a href=https://gohugo.io/>Hugo</a> y <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target=_blank rel="license noopener noreferrer" style=display:inline-block>CC BY-SA 4.0<img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></ul></div></div></div></footer><script src=/main.2507c05f91ee016250e43b67b3d342f5a0d9d4dc5264f76cdc4518cd36a9e04cf3022ce8362802e618d8130b6733b53ee845a49e67229eeb3d3e70347db96a2b.js integrity="sha512-JQfAX5HuAWJQ5Dtns9NC9aDZ1NxSZPds3EUYzTap4EzzAizoNigC5hjYEwtnM7U+6EWknmcinus9PnA0fblqKw==" crossorigin=anonymous defer></script><script src=/index.min.108c8ff73af2a7d2b242db281af551760573d8d60883aba05029b7223249a57ffe752f54c997cedbd2b7fd27a3d5bac5dc7e3084101518bd98dc104cc9954ce3.js integrity="sha512-EIyP9zryp9KyQtsoGvVRdgVz2NYIg6ugUCm3IjJJpX/+dS9UyZfO29K3/Sej1brF3H4whBAVGL2Y3BBMyZVM4w==" crossorigin=anonymous defer></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>